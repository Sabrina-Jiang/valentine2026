:root { --bg: #0a0a0a; --gold: #d4af37; --red: #7f1d1d; }
body, html { margin: 0; padding: 0; width: 100%; height: 100%; background: var(--bg); color: #d1d1d1; font-family: 'Special Elite', monospace; overflow: hidden; touch-action: none; }
.grain-overlay { position: fixed; inset: 0; z-index: 1000; opacity: 0.04; pointer-events: none; background: url('https://upload.wikimedia.org/wikipedia/commons/7/76/1k_Noise_Texture.png'); }

section { position: fixed; inset: 0; display: none; flex-direction: column; align-items: center; justify-content: center; padding: 20px; box-sizing: border-box; }
.stage-visible { display: flex !important; animation: fadeIn 0.8s; }

/* 回归经典开场布局 */
.envelope { width: 280px; height: 380px; background: #1a1a1a; border: 1px solid #222; position: relative; display: flex; flex-direction: column; align-items: center; justify-content: center; box-shadow: 0 40px 80px #000; }
.wax-seal { width: 60px; height: 60px; background: radial-gradient(#9b1c1c, #7f1d1d); border-radius: 50%; position: absolute; bottom: 20%; box-shadow: 0 4px 10px #000; }
.wax-seal::after { content: 'V'; color: rgba(0,0,0,0.3); font-size: 24px; line-height: 60px; text-align: center; width: 100%; display: block; }
.envelope-label { border-top: 1px solid #333; border-bottom: 1px solid #333; padding: 15px; width: 80%; text-align: center; }
.top-secret { color: var(--red); font-size: 10px; letter-spacing: 0.4em; display: block; }

/* 打字机和指纹 */
.typewriter-container { font-size: 13px; line-height: 1.6; text-align: center; color: #aaa; margin-bottom: 20px; min-height: 80px; }
#fingerprint-btn { width: 80px; height: 80px; border: 1px solid #222; border-radius: 15px; position: relative; display: flex; align-items: center; justify-content: center; margin: 0 auto; }
#progress-ring { fill: transparent; stroke: var(--gold); stroke-width: 2; stroke-dasharray: 238.76; stroke-dashoffset: 238.76; transition: stroke-dashoffset 0.1s linear; }
.progress-svg { position: absolute; inset: 0; transform: rotate(-90deg); }

/* Phase 1 核心呼吸 */
#clock-container { position: relative; width: 220px; height: 220px; display: flex; align-items: center; justify-content: center; margin: 20px 0; }
#time-ring { position: absolute; inset: 0; border: 2px solid #1a1a1a; border-radius: 50%; }
#hour-hand-p1 { width: 2px; height: 90px; background: var(--gold); position: absolute; bottom: 50%; left: 50%; transform-origin: bottom; }
#marker-9 { position: absolute; left: 0; top: 50%; width: 12px; height: 2px; background: #333; }
.marker-active { background: var(--gold) !important; box-shadow: 0 0 10px var(--gold); }
#breath-core { width: 50px; height: 50px; background: radial-gradient(circle, var(--gold), transparent); border-radius: 50%; z-index: 10; animation: breathe-pulse 2s infinite; cursor: pointer; }

/* Phase 2: 拼字横向修复核心样式 */
#diner-puzzle { width: 100%; max-width: 320px; display: flex; flex-direction: column; align-items: center; }
.word-slots { display: flex; flex-direction: row; flex-wrap: wrap; justify-content: center; gap: 4px; margin-bottom: 20px; width: 100%; }
.letter-pool { display: flex; flex-direction: row; flex-wrap: wrap; justify-content: center; gap: 8px; width: 100%; padding: 0 10px; }

.slot, .letter { 
    width: 28px; height: 35px; border: 1px solid #333; 
    display: flex; align-items: center; justify-content: center; 
    font-size: 14px; color: var(--gold); background: #050505;
}
.letter { cursor: pointer; box-shadow: 0 2px 4px rgba(0,0,0,0.5); }
.letter:active { background: #1a1a1a; }

/* 其它视觉 */
.photo-frame { width: 280px; height: 160px; background: #111; border: 1px solid #222; overflow: hidden; margin-bottom: 20px; }
.photo-frame img { width: 100%; height: 100%; object-fit: cover; opacity: 0.1; filter: grayscale(1); transition: 1s; }
.big-cup { font-size: 50px !important; margin: 0 15px; cursor: pointer; opacity: 0.2; transition: 0.5s; }
#canvas-container { position: relative; width: 280px; height: 380px; border: 1px solid #222; }
#ica-canvas { position: absolute; inset: 0; z-index: 10; touch-action: none; }

@keyframes breathe-pulse { 0%, 100% { transform: scale(1); opacity: 0.4; } 50% { transform: scale(1.2); opacity: 0.8; } }
@keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
.hidden { display: none !important; }