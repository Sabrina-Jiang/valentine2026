:root { --bg: #0a0a0a; --gold: #d4af37; --red: #7f1d1d; }
body, html { margin: 0; padding: 0; width: 100%; height: 100%; background: var(--bg); color: #d1d1d1; font-family: 'Special Elite', monospace; overflow: hidden; touch-action: none; }
.grain-overlay { position: fixed; inset: 0; z-index: 1000; opacity: 0.04; pointer-events: none; background: url('https://upload.wikimedia.org/wikipedia/commons/7/76/1k_Noise_Texture.png'); }

section { position: fixed; inset: 0; display: none; flex-direction: column; align-items: center; justify-content: center; padding: 25px; box-sizing: border-box; }
.stage-visible { display: flex !important; animation: fadeIn 1s; }

/* BPL 优化 UI */
.bpl-decoder-box { width: 100%; max-width: 300px; text-align: center; }
.clue-text { font-size: 14px; color: #888; margin-bottom: 30px; font-style: italic; }
.input-wrap { position: relative; margin-bottom: 30px; }
#bpl-input { background: transparent; border: none; color: var(--gold); text-align: center; width: 100%; font-size: 18px; letter-spacing: 2px; outline: none; font-family: inherit; }
.input-line { height: 1px; background: linear-gradient(90deg, transparent, var(--gold), transparent); width: 100%; margin-top: 5px; opacity: 0.5; }
#bpl-btn { background: transparent; border: 1px solid var(--gold); color: var(--gold); padding: 12px 25px; font-size: 12px; cursor: pointer; letter-spacing: 1px; transition: 0.3s; }
#bpl-btn:active { background: var(--gold); color: black; }

/* Final Message 结尾设计 */
.timeline-box { text-align: left; margin-bottom: 50px; opacity: 0; transform: translateY(20px); transition: 2s; }
.time-item { font-size: 14px; margin: 15px 0; color: #888; }
.time-item span { color: var(--gold); font-weight: bold; margin-right: 10px; }
.show-timeline { opacity: 1 !important; transform: translateY(0) !important; }

#love-note { text-align: center; }
.decrypt-msg { font-size: 16px; margin-bottom: 5px; opacity: 0; animation: fadeIn 2s forwards 1s; }
.designer-msg { font-size: 14px; color: #666; opacity: 0; animation: fadeIn 2s forwards 2.5s; }
.love-msg { font-size: 18px; color: var(--gold); margin-top: 25px; opacity: 0; animation: fadeIn 3s forwards 4s; letter-spacing: 1px; }

/* 基础样式保持同步 */
.envelope { width: 280px; height: 380px; background: #1a1a1a; border: 1px solid #222; display: flex; flex-direction: column; align-items: center; justify-content: center; box-shadow: 0 40px 80px #000; }
.wax-seal { width: 60px; height: 60px; background: radial-gradient(#9b1c1c, #7f1d1d); border-radius: 50%; position: absolute; bottom: 20%; }
.word-slots { display: flex; flex-wrap: wrap; justify-content: center; gap: 4px; margin-bottom: 20px; width: 100%; }
.letter-pool { display: flex; flex-wrap: wrap; justify-content: center; gap: 8px; width: 100%; }
.slot, .letter { width: 28px; height: 35px; border: 1px solid #333; display: flex; align-items: center; justify-content: center; font-size: 14px; color: var(--gold); }
#canvas-container { position: relative; width: 280px; height: 380px; border: 1px solid #222; cursor: crosshair; }
#ica-canvas { position: absolute; inset: 0; z-index: 10; }
#ica-bg { width: 100%; height: 100%; object-fit: cover; }

@keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
.hidden { display: none !important; }